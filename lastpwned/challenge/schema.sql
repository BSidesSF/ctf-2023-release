CREATE DATABASE IF NOT EXISTS lastpwned;

CREATE USER IF NOT EXISTS 'lastpwned'@'%' IDENTIFIED BY 'hacktheplanet';

GRANT SELECT, INSERT, UPDATE on lastpwned.* TO 'lastpwned'@'%';

USE lastpwned;

CREATE TABLE IF NOT EXISTS users (
  username VARCHAR(64) NOT NULL PRIMARY KEY,
  passhash CHAR(60) NOT NULL
);

CREATE TABLE IF NOT EXISTS keybags (
  username VARCHAR(64) NOT NULL,
  generation INT NOT NULL,
  keyhash CHAR(64),
  iter INT NOT NULL DEFAULT 1,
  ctime DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  keybag MEDIUMBLOB,
  PRIMARY KEY(username, generation)
);

INSERT INTO `keybags` VALUES (
  'admin',0,NULL,1,'2023-02-10 06:37:02',NULL);
INSERT INTO `keybags` VALUES (
  'admin',1,'b3b366a6a156ecd6bc2e7f36aee253796dc04969a23152c97be368862c1c85b3',
  1,'2023-02-10 06:37:02',
  0x8E2577D0FE6807A6DC136491195D03D00B88EE1BCC663C05226DB4CA39E3);
INSERT INTO `keybags` VALUES (
  'admin',2,'b3b366a6a156ecd6bc2e7f36aee253796dc04969a23152c97be368862c1c85b3',
  1,'2023-02-10 06:37:27',
  0xB14AD781EF80D3960B9AA5AA35E1E60C58521891A94C98C7AB96A130206233EF587082DF652D267900E74DDADB4D01630E166DF89F52875E448466E9E4E803B5359BA49250298CFC9227249B57313BF0F76C4B0CD100EAA37F7484754A163C6F918A2B9EAC3AA3C80BC10B4E35E10BF2E43A6E509811FA5648BEF0A83139BFAEAD469D0E0F67FD469F81351A4DDC46989FC1106C005BF3FF808846CC747E);
INSERT INTO `keybags` VALUES (
  'admin',3,'b3b366a6a156ecd6bc2e7f36aee253796dc04969a23152c97be368862c1c85b3',
  1,'2023-02-10 06:38:13',
  0xFCEA0BFE3AFD37717F6F2A95114C1ABA5E4AF2C203E314746510CA41E89312CD0D4CC694F5A722BF51606CD1509C06BB2846371385911AB91E13734F4F6718A01734F14CF98B118789C9BA3E309287EA89D3C07E762139D86DC9D8F454A8DAB36630EBA592F118790509CECEB0692247B0C70EA4EDD8DE5716E73E6201E894C884A7A06F4A26201EC7B96D0C065288B49529BB167567F255A90184A600ACF4F1EECD1469ACF28AEBB0DA75377D106AE62CE8EE2087EBB9DFBD3AEE3472021B3EF9ADD49CDE0C79C18DD2DCEC24820B7166B6D2B4A3E70D7066BA0DA15D3C5E1F861AD10F617FF0EA5A0929746926ABA47738A3B4CCC2CF8CDDC649B90728431F54EE65DF3CF2CEE5303502F059EC7CB97F86259FD98D8D5F15D91E85);
INSERT INTO `keybags` VALUES (
  'admin',4,'b3b366a6a156ecd6bc2e7f36aee253796dc04969a23152c97be368862c1c85b3',
  1,'2023-02-10 06:39:00',
  0x8E3EA85682F529902B224636FA7113D508D327488CE03971259D979D0D9C9C736E898E34A5D595B6EA22D057BFD98F3A48E81627AD2CD46B6915404AE696F4F97C4983975A31239904E0FE268611C0B10DC7FF14094AB54F4B8F44D6F92A00151D57C406777658AAF5E06EDE9A7F17F1C60978558D629971ADBD16C7BF3BAEC00789A7727F9C12E44BEE8C95E1A7D4C0AB8734DAFF42F2FC69F93A7C0AE87CCEB38A2511FE4D27CDED280914395087B95C12CBFABD853DF9F3399FB244235E3EA7C14EBC8B4A3E68242EB66C373DF31FE1A2B310500D22A2E44D9E1FA7ABB82C2097A3E7DA8C00D86EBFF6EC2E367F72A1206F36F1D00FCD27CA108E1DF5268EFBF51340BA36DB46D14F9129D5B0BCBDEA4A49165F0F6F6C2EECAF0DE1FCFACE87EAD0C1A20BCF7923C707B5751A4A46AD8B07E1569978A395D11B6A43261B4038F8AD1F459F052D9D0A46D074B0F0CBE1A15F2610F302028751B20F8D0D6C3916ECEBE17013E77E726049965A0CF45051A0D9A88CEE3C4D0DD38BF2B526F60DF32AA698AD03384DAB66033589F86A336B6B75F2E0A7C7DEFBB2E7DB9CEE605A3C31EBBC49);
INSERT INTO `keybags` VALUES (
  'admin',5,'98de66f513a66d023e15bf027818253aff1dda67b9b10416139d1f1294c0bb63',
  100,'2023-02-10 06:40:56',
  0x15AA9DE82BE42A3C4FC81F586F79EE210B27359580DBEE6B50E73F2DF8ED81B1587975F250BE851A9B68EFC99833EF5DEBFE2C4487BB8F28E06EEB80D694B7BEAA6DED410D1533547C3EB5CEC7989A455AFB728ECCAA55EC2D3FEE65162CA763FA4492F12E72A04E77027074C4A97B15DE0B87FEE7A9FD8CD6DC76AA4B2C3BBD4385C92CEEC7E288CA9E3C32E24F71B0A091844B79384B1061D3A691BA250427F2DD3FB034E58608667044763C19B5237CE1C83295AE2BB6B8BB1FAE237A91DD840D6B0EA2DD2C271D30689E829A75BBE63BDC6DEFBA27A1A7DC9A885F348E25502096AB3EEAEF493020BDE961FDAFFA60D4B58A46EFFFFF0B09ABD858EA7A539818B1F1DFB37917DF3615B118BE8CB081A8CB89607826A756C889EDE6ED10206AC8BD6C16518E8DF994F6E761E8FC3EA061672AF4F30C4D3B57955D03C5B8AADF91104069743058D4AAC404B1B3FFBB949A83E65F78ED5F9FDCE4AA37F625DA2498499DFE7AB91EA6841EEAB74EFF065A0516BACE221336BB3DF40D35BA683534B42BE8828CAF9003BA7C62D11D5A7CED315CB23AAC482513673AE9D0C861C15BD0E6B452);

INSERT INTO `users` VALUES (
  'admin','$2a$10$UNcEI.00tLM6IT1OFna28utc0u19p0VxuMR1ESprElPttno2PC5Gq');
